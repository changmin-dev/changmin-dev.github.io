---
laytout: post
title: 2018년 6월 15일 TIL
tags: [TIL]
---

## 네트워크

### NAT(Network Address Transition), NAPT(Network Address Port Transition)
NAT를 이용해서 게이트웨이를 지날때 IP주소를 변경한다. NAT를 사용하면 보유하고 있는 글로벌 IP주소 보다 많은 호스트는 동시에 접속이 불가능하다. 때문에 NAPT를 사용한다. NAPT는 포트 번호를 추가로 변환해서 하나의 글로벌 IP주소로 복수의 컴퓨터를 접속하도록한다.  
NAPT 테이블에 없는 포트는 변환이 지원되지 않기 떄문에 내부 네트워크에 들어 올 수 없어서 보안상의 이점이 있지만, 내부 네트워크에서 외부로 공개하려는 내용도 공개가 힘들다. 내부 네트워크에서 외부에 공부하기 위한 주소는 NAPT에 미리 저장해 둔다. 이를 정적 NAPT라고 한다.
- 사설 IP 주소: 내부 네트워크에서 TCP/IP를 이용할 경우에는 사설 IP 주소를 사용한다.
- 글로벌 IP 주소: ICANN이 관리하는 IP주소

### OSI 5계층 세션 계층 
데이터를 주고받기위해서 세션을 생성하고 관리한다. 이를 다이얼로그 제어라고 한다. TCP/IP 소켓이 여기에 해당된다. 완전하게 대응되는 프로토콜을 찾기가 힘들다.
- 세션 : 둘 이상의 소프트웨어 애플리케이션 프로세스 간의 지속적인 논리적 연결로 데이터를 교환할 수 있도록 하는 것

### OSI 6계층 표현 계층
목적에 맞는 데이터 형식으로 표현 하도록 한다. 그리고 압축이나 암호화를 수행한다.

### SSL(Secure Sokets Layer) / TLS(Transport Layer Security)
서버와 클라이언트 사이의 통신 구간에 대한 보안 수준을 높이기 위한 프로토콜. 인증 기관에서 발행된 서버 인증서를 사용해서 서버를 증명하고 통신 구간을 암호화 하며, 데이터의 위변조를 막는다. 과거에 SSL이라고 불리던 것을 IETF에서 표준화시켜서 TLS이 되었다.
HTTPS같은 프로토콜이 기존의 프로토콜에 TLS가 적용된 것이다.
1. 클라이언트에서 접속 요청을 하면 서버에서 클라이언트에게 전자 인증서와 공개키를 보낸다.
2. 클라이언트는 서버의 신원을 확인하고 난수를 사용한 공유키를 생성해서 서버의 공개키로 암호화해서 서버로 전송한다.
3. 공유키를 이용해서 암호화 통신을 한다.

### 전자 인증서
인증기관(CA, Certificate Authority)에게 발급 받은 정보이다. 인증기관이 보증하는 전자 서명과 공개키가 포함되어 있다.

### 전자 서명
데이터가 위변조 되지 않았다는 것과 누가 보낸 것인지를 보증하는 역할이다. 원본데이터의 해시 값을 구한 후 개인키로 암호화 해서 만든다.
공개키와 함께 공개 해서 공개키로 메시지 다이제스트가 일치하는지 확인한다.
- 메시지 다이제스트: 데이터에 대한 요약 정보. 동일한 문서에 대해서는 동일한 정보가 만들어진다. 해시 함수나 다제이스트 함수로 만든다.

### 공유 키 암호화와 공개 키 암호화
- 공유키 암호화 : 하나의 공유 키를 사용해서 암호화 하는 방식. 간단하고 빠르지만, 공개키가 유출 되면 문제가 된다. 대칭키 암호화라고도 한다.
- 공개키 암호화 : 개인 키와 공개 키를 이용해서 암호화를 하는 방식. 한쪽 키로 암호화한 것은 다른 한쪽 키로만 복호화 할 수 있다. 개인 키는 자신이 보관하고 공개 키를 사전에 전달한다.

### OSI 7계층 어플리케이션 계층
네트워크 서비스를 제공한다. HTTP같은 프로토콜이 해당된다.

## Java 어노테이션
어노테이션은 실행 과정에서 코드를 어떻게 컴파일하고 처리할 것인지를 알려주는 정보이다.

### 어노테이션의 용도
1. 컴파일러에게 코드 문법 에러를 체크하도록 정보를 제공
2. 소프트웨어 개발툴이 빌드나 배치시 코드를 자동으로 생성할 수 있도록 정보를 제공
3. 실행시 특정 기능을 실행하도록 정보를 제공

### 어노테이션 정의와 사용
```java
@Target(ElementType.TYPE, ElementType.FILED)
@Retention(RetentionPolicy.RUNTIME)
public @interface 어노테이션이름 {
    ...
}
```
- `@Target` : 어노테이션의 적용 대상. 상수로 적용한다.(ElementType.Class 등) ,를 통해 복수로 적용이 가능하다.
- `@Retention` : 어노테이션의 유지 정책. `RetentionPolicy.RUNTIME`, `RetentionPolicy.CLASS`,`RetentionPolicy.SOURCE` 3가지이다. 

다음은 위에 정의한 어노테이션을 사용한 모습이다. 클래스(TYPE)와 맴버(FILED)에 적용하였다.
```java
@어노테이션 이름
class 클래스{
    @어노테이션 이름
    int member 
}
```

### 값 적용하기
```java
public @interface MyAnotation {
    String element1();
    int element2 defalut = 10;
}
```

다음과 같이 사용한다.
```java
//default를 사용해서 element2는 생략이 가능하다.
@MyAnotation(element1 = "value");
```

