---
laytout: post
title: 2018년 6월 7일 TIL
tags: [TIL]
---

## OSI 1계층
신호를 디지털에서 아날로그로 아날로그를 디지털로 변환

### 신호에서 발생하는 문제
- 감쇠 : 긴 케이블을 지나는 동안 신호가 약해지는 현상. 리피터나 허브를 이용해 증폭을 한다.
- 노이즈 : 외부 요인에 의해서 전기 신호의 형태가 무너지는 현상. 케이블에 실드 처리를 해서 막는다. 광신호는 노이즈를 받지 않는다.  
- 충돌 : 신호가 보내지고 있는 도중에 다른 신호를 보내는 경우에 발생한다.

### 허브
복수의 기기를 연결해서 네트워크를 구축한다. 그리고 신호의 증폭과 재생을 한다.(Active 허브의 경우) 허브에 연결된 기기는 하나의 케이블과 동일한 취급을 받게 된다. 허브끼리 연결되는 경우를 연속 접속(Cascade Connection) 이라고 한다. 
- 플러딩 : 허브는 수신한 포트 이외의 모든 포트에 수신한 신호를 송신한다. 이를 플러딩이라고 한다.
- 충돌 도메인 : 허브는 수신한 포트를 제외하고 연결된 모든 포트에 신호를 보내므로 허브에 연결된 장치들은 충돌이 발생할 수 있다. 충돌이 발생하는 범위를 총돌 도메인이라고 한다. 허브에 연결된 장치들은 같은 충돌 도메인에 있게된다.

## OSI 2계층
신호가 닿는 범위(네트워크 내부 - 라우터 없이 분배로 연결되어 있는 범위, 라우터와 라우터 간의 범위)에서의 데어터 전송을 담당, 보통 허브로 연결된 컴퓨터들의 통신을 담당한다. 대표적으로 이더넷이 있다.

## 이더넷
LAN의 사실상 표준. 기본적으로 신호는 모든 기기에 도달하지만, 수신처의 MAC주소를 보고 자기에게 온 것을 제외하고는 파기한다.
- 프레이밍 : 송수신되는 비트열에 의미를 주어 데이터로 취급할 수 있게 한다. 프리엠블(8비트) + 어드레스(16비트)로 구성된다.
- 어드레싱 : 주소를 어떻게 보낼것인가를 결정하는 방법. 
- Mac주소 : 인터페이스가 가지는 고유주소. 유니캐스트주소로 유일해야한다. 48비트 값으로 4비트마다 16진수로 표시 (AB-CD-EF-01-23-45), 앞의 24비트는 제조업체의 번호인밴더코드, 뒤의 24비트는 제조사가 붙인 코드이다.
- 이더넷 프레임 : 수신처 MAC주소(48비트), 송신처 MAC주소(48비트), 타입(16비트), 페이로드(368~12000비트), FCS(32비트)

#### FCS
에러를 체크하기 위한 방법 통신 도중에는 에러를 고칠수 없다. 에러가 발생한 프레임은 제거된다. 파기했다는 것을 송신측에 알리지 않는다.

### CSMA/CD(Carrier Sense Multiple Access/Collision Detection)
이더넷에서 충돌을 피하기 위해 사용하는 엑세스 제어. 반이중 방식이다.
- CS(신호 감지): 누군가 송신하면 송신하지 않는다.
- MA(다중 접속): 아무도 송신하고 있지 않는다면 송신이 가능하다. 
- CD(충돌 감지) : 송신 후에 충돌이 일어나면 다시 보낸다.

### 스위치
스위치는 수신한 프레임을 따로따로 보낼 수 있도록 처리해서 충돌을 막을 수 있다. 스위치를 이용하면 CSMA/CD를 사용하지 않고 전이중 통신이 가능해진다. 이를 전이중 이더넷이라고 부른다.
- 학습 : 수신한 프레임의 송신 처 MAC주소를 기록해서 수신한 포트와 MAC주소를 연관 짓는다.
- MAC 주소 필터링 : 프레임의 수신처 MAC 주소를 보고 학습한 테이블에서 그 MAC주소가 있는 포트만 프레임을 전달한다.
- 버퍼링 : 수신처가 같은 프레임이 동시에 들어 올 경우 충돌할거 같은 프레임을 버퍼에 일시적으로 저장한다. 버퍼가 가득차면 통신이 일시적으로 중단 될 수 있다.(백 프레셔 - JAM신호, IEEE802.3X - PAUSE 프레임)

### 통신 방법과 주소
각 통신 방법에 따라서 대응하는 주소가 존재한다.
- 유니 캐스트: 특정한 기기 1대만 수신처인 데이터 통신,기기를 지정하는 주소가 필요하다.(유니캐스트 주소)
- 멀티 캐스트: 복수의 기기를 수신처로 하는 전송, 수신처 그룹에 해당하는 주소가 필요하다.(멀티 캐스트 주소)
- 브로드 캐스트: 모든 기기가 수신처인 데이터 통신, 전체를 수신자로 사용하는 주소가 필요하다.(브로드 캐스트 주소)

## OSI 3계층 - 네트워크 계층
네트워크(=세그먼트) 간(라우터와 라우터)에서의 데이터 송수신을 한다. 라우터를 넘어서는 브로드캐스트는 송신되지 않는다. 각 네트워크
- 인터넷(Internet, Internetwork) : 네트워크끼리의 데이터 송수신
- 어드레싱 : 2계층에서 사용되는 MAC주소는 장소를 특정할 수 없는 주소이다. 3계층에서는 어디에 있는지와 같은 위치 정보를 가지는 주소를 사용한다.
- 라우팅 : 수신처까지 어떤 경로로 갈지를 결정

## 인터넷 프로토콜(IP)
어드레싱과 라우팅을 담당하는 프로토콜
IPv4, IPv6이 있다 두 버전은 호환 되지 않는다.

### IP 데이터 그램(패킷)
1. 버전 : 4, IP의 버전
2. 헤더길이 : 4 IP헤더의 길이
3. 서비스 타입 : 8 패킷의 우선도/ 중요도 
4. 데이터 길이 : 16, IP헤더와 페이로드를 합친길이
5. ID : 데이터그램의 식별번호
6. 플래그 : 데이터 그램을 분할 했는지 여부
7. 프래그먼트 오프셋 : 분할한 경우 본래대로 되돌릴때 사용
8. TTL : 패킷의 생존시간
9. 프로토콜 : 상위 프로토콜 지정
10. 헤더 체크섬 : IP헤더의 에러 체크용 코드
11. 송신처 IP 주소 : 송신처의 논리 주소
12. 수신처 IP 주소 : 수신처의 논리 주소
13. 옵션 : 생략가능, 특별한 설정을 할 경우

### IP 주소
계층형, 네트워크 관리자가 컴퓨터가 접속할때마다 컴퓨터에 할당한다. 유니 캐스트 IP 주소는 소속된 네트워크에서 유일해야 한다.
32비트(v4)로 되어 있다. 원래는 비트의 연속이지만, 사람이 읽기 좋도록 8비트마다 10진수로 표현한다. 이를 옥텟이라고 부른다. 32비트이므로 4개의 옥텟으로 구성된다.

### IP 클래스 
클래스를 사용하는 방법을 클래스풀 어드레싱라고 한다.제일 앞부분으로 나눈다.(네크워크 번호 부분 나머지는 호스트 번호) 상위 클래스 일수록 많은 컴퓨터를 소유하는 네트워크가 된다. `현재는 클래스를 사용하지 않는다. `
- A클래스: 0xxxxxxx/xxxxxxxx/xxxxxxxx/xxxxxxxx
- B클래스: 10xxxxxx/xxxxxxxx/xxxxxxxx/xxxxxxxx
- C클래스: 110xxxxx/xxxxxxxx/xxxxxxxx/xxxxxxxx
- D클래스: 1110xxxx/xxxxxxxx/xxxxxxxx/xxxxxxxx
- E클래스: 1111xxxx/xxxxxxxx/xxxxxxxx/xxxxxxxx
- 서브넷 : 호스트번호의 비트를 서브넷 번호와 호스트 번호로 분해서 네트워크를 분할한다.
- 서브넷 마스크 : 어디까지 서브넷인지를 알기 위한 정보. 네트워크 번호와 서브넷 번호의 비트수를 나타내기 위해 IP주소와 함께 기술한다. 

#### 특별한 주소
- 네트워크 주소 : 하위 8비트가 모두 0 (x.x.x.255)
- 브로트캐스트 주소 : 하위 8비트가 모두 1(x.x.x.255)

### 클래스리스 어드레싱
클래스를 사용하게 되면 사용하지 않는 IP주소가 있지만, IP주소의 수요가 많아져서 할당할 IP주소가 부족하게 되었다. 때문에 클래스리스 어드레싱을 사용하게 되었다. 클래스리스는 클래스대신 필요에 따른 비트수로 네트워크 번호와 호스트 번호의 비트수를 결정한다. 이 비트의 수를 나타내는 값을 프리픽스 길이라고한다.
- 프리픽스 길이(Prefix-Length) : `주소 / 프리픽스 길이`의 형태로 표현된다. 상위 n비트를 네트워크 번호로 사용한다는 의미이다.

### DHCP
동적 호스트 설정 프로토콜. IP, 서브넷 마스크, 디폴트 게이트웨이, 대여기간등을 설정 한다. Server와 Client로 나누어진다. DHCP Server는 IP Address Pool중에서 요청한 DHCP Client에게 각각 유일한 것이 되도록 주소를 할당 한다. `DHCP 자체는 응용 계층이다!!!!!`
- IP Address Pool: 네트워크 관리자가 사전에 정한 할당할 주소의 범위
- 대여기간: 네트워크 관리자가 결정하는 클라이언트 측이 IP주소를 할당 받는 기간. 클라이언트가 계속 사용하고 싶으면 연장 요청을 해야한다.
- DHCP 메시지 : 
- DHCP 메시지 타입 : DISCOVER, OFFER, REQUEST, ACK 4가지 종류

### ARP
수신처의 MAC주소를 알아내는 방법. 네트워크 계층 프로토콜이다. ARP테이블에서 주소를 알아낸다. 테이블에 없다면 ARP 요청을 보낸다. ARP 응답이 도착하면 테이블에 기록된다. 테이블에 있는 MAC주소는 5분 정도만 남아있다.

### DNS
IP를 Domain Name에 대응시킨 체계. `응용 계층`이다.
- Domain Name : 사람이 이해하기 좋은 방법으로 주소를 표현. IP와 대응된다.
- DNS Resolve: Domain Name으로 부터 수신처의 IP주소를 알아 내는 방법. 해당 지역의 로컬 네임 서버에게 먼저 가서 확인 후 정보가 없으면 Root네임서버에게 가서 확인하고 계층적으로 찾아간다.(www.github.com 이라면 루트/.com/.github.com 순으로 찾아 간다.)
- Root Name Server: 최상위의 네임서버 

### 데이터 전송 위한 주소획득 과정
1. 자신의 IP주소는 수동, 또는 DHCP에서 할당 받고, MAC주소는 NIC로부터 획득
2. 사용자 어플리케이션이 수신처의 도메인 명을 결정하면 DNS로 IP주소를 획득
3. IP주소가 결정되면 ARP로 MAC주소 획득
